<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ProgressIndicator?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.control.MenuButton?>
<?import javafx.scene.control.MenuItem?>

<StackPane maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" prefHeight="700.0" prefWidth="1250.0" stylesheets="@application/style.css" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="application.Controller">
   <children>
      <AnchorPane prefHeight="700.0" prefWidth="1250.0">
         <children>
            <!-- Header -->
            <AnchorPane prefHeight="60.0" prefWidth="1250.0" styleClass="bottom-border">
               <children>
                  <AnchorPane layoutX="43.0" layoutY="5.0" prefHeight="50.0" prefWidth="60.0">
                     <children>
                        <ImageView fitHeight="50.0" fitWidth="60.0" layoutX="5.0" pickOnBounds="true" preserveRatio="true">
                           <image>
                              <Image url="@/logo.png" />
                           </image>
                        </ImageView>
                     </children>
                  </AnchorPane>
                  <Label fx:id="homeLabel" layoutX="479.0" layoutY="22.0" styleClass="textt3" text="Home" />
                  <Label fx:id="jobLabel" layoutX="586.0" layoutY="22.0" styleClass="textt3" text="Job" />
                  <MenuButton fx:id="profileButton" layoutX="1054.0" layoutY="14.0" mnemonicParsing="false" 
                              styleClass="loginBTN,dynamic-profile-button" text="Profile">
                     <items>
                        <MenuItem mnemonicParsing="false" text="My Profile" />
                        <MenuItem fx:id="coursesMenuItem" mnemonicParsing="false" onAction="#handleCoursesMenuItem" text="Courses" />
                        <MenuItem mnemonicParsing="false" onAction="#logoutBtn" text="Logout" />
                     </items>
                  </MenuButton>
               </children>
            </AnchorPane>
            
            <!-- Main Content Area -->
            <AnchorPane layoutY="60.0" prefHeight="640.0" prefWidth="1250.0">
               <children>
                  <!-- Left Sidebar -->
                  <AnchorPane prefHeight="640.0" prefWidth="200.0" style="-fx-background-color: #F5F5F5;" styleClass="rightSide-border">
                     <children>
                        <VBox layoutX="25.0" layoutY="20.0" prefWidth="150.0" spacing="20.0">
                           <children>
                              <Label styleClass="headlineFeature" text="Menu" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-padding: 0 0 10 0;" />
                              <Button mnemonicParsing="false" onAction="#jobDashboardAdzunaPage" prefHeight="40.0" prefWidth="150.0" styleClass="deshboardBTN" text="Dashboard" />
                              <Button mnemonicParsing="false" onAction="#jobDashboardAdzunaPage" prefHeight="40.0" prefWidth="150.0" styleClass="deshboardBTN" text="Job Matches" />
                              <Button mnemonicParsing="false" onAction="#cvUploadPage" prefHeight="40.0" prefWidth="150.0" styleClass="deshboardBTN" text="Upload CV" />
                           </children>
                        </VBox>
                     </children>
                  </AnchorPane>
                  
                  <!-- Main Analysis Area -->
                  <ScrollPane layoutX="200.0" prefHeight="640.0" prefWidth="1050.0" fitToWidth="true" style="-fx-background-color: transparent;">
                     <content>
                        <AnchorPane prefHeight="900.0" prefWidth="1030.0">
                           <children>
                              <!-- Page Title -->
                              <Label layoutX="20.0" layoutY="20.0" styleClass="headlineFeature" text="Match Analysis" />
                              
                              <!-- Job Details Section -->
                              <AnchorPane layoutX="20.0" layoutY="60.0" prefHeight="200.0" prefWidth="990.0" styleClass="totalDashboard">
                                 <children>
                                    <!-- Job Information -->
                                    <VBox layoutX="20.0" layoutY="20.0" prefHeight="160.0" prefWidth="500.0" spacing="8.0">
                                       <children>
                                          <Label fx:id="matchJobTitleLabel" styleClass="jobTitle" text="Loading..." />
                                          <HBox spacing="10.0">
                                             <children>
                                                <Button mnemonicParsing="false" styleClass="open" text="Open" prefWidth="60.0" prefHeight="25.0" />
                                                <Label fx:id="matchJobCompanyLabel" styleClass="update" text="Loading..." />
                                             </children>
                                          </HBox>
                                          <Label fx:id="matchJobLocationLabel" styleClass="update" text="Loading..." />
                                          <Label fx:id="matchJobSalaryLabel" styleClass="title" text="Loading..." />
                                          <Label styleClass="update" text="Created By Tiger IT" />
                                       </children>
                                    </VBox>
                                    
                                    <!-- Match Progress and Result -->
                                    <VBox layoutX="520.0" layoutY="20.0" prefHeight="160.0" prefWidth="450.0" alignment="CENTER" spacing="15.0">
                                       <children>
                                          <StackPane prefHeight="80.0" prefWidth="80.0">
                                             <children>
                                                <ProgressIndicator fx:id="matchProgressIndicator" progress="0.0" prefHeight="80.0" prefWidth="80.0" style="-fx-accent: #E91E63;" />
                                                <Label fx:id="matchPercentageLabel" styleClass="title" text="0%" textAlignment="CENTER" style="-fx-font-size: 16px; -fx-font-weight: bold;" />
                                             </children>
                                          </StackPane>
                                          <Label fx:id="matchResultLabel" prefHeight="40.0" prefWidth="300.0" styleClass="Congrasheading" text="Analyzing..." textAlignment="CENTER" wrapText="true" style="-fx-font-size: 18px; -fx-font-weight: bold;" />
                                       </children>
                                    </VBox>
                                 </children>
                              </AnchorPane>
                              
                              <!-- Skills Analysis Section -->
                              <AnchorPane layoutX="20.0" layoutY="280.0" prefHeight="270.0" prefWidth="990.0">
                                 <children>
                                    <Label layoutX="0.0" layoutY="10.0" styleClass="headlineFeature" text="Skills Analysis" />
                                    <HBox layoutX="0.0" layoutY="45.0" spacing="20.0" prefHeight="200.0" prefWidth="990.0" alignment="TOP_CENTER">
                                       <children>
                                          <!-- Matched Skills -->
                                          <VBox spacing="10.0" prefWidth="480.0" HBox.hgrow="ALWAYS">
                                             <children>
                                                <Label styleClass="update" text="✓ Matched Skills:" />
                                                <ScrollPane prefHeight="180.0" prefWidth="480.0" style="-fx-background-color: transparent; -fx-border-color: #4CAF50; -fx-border-width: 2px; -fx-border-radius: 5px;" fitToWidth="true" vbarPolicy="AS_NEEDED" hbarPolicy="NEVER">
                                                   <content>
                                                      <VBox fx:id="matchedSkillsBox" prefWidth="460.0" style="-fx-background-color: #E8F5E8; -fx-padding: 10px;" spacing="5.0" />
                                                   </content>
                                                </ScrollPane>
                                             </children>
                                          </VBox>
                                          <!-- Missing Skills -->
                                          <VBox spacing="10.0" prefWidth="480.0" HBox.hgrow="ALWAYS">
                                             <children>
                                                <Label styleClass="update" text="✗ Missing Skills:" />
                                                <ScrollPane prefHeight="180.0" prefWidth="480.0" style="-fx-background-color: transparent; -fx-border-color: #F44336; -fx-border-width: 2px; -fx-border-radius: 5px;" fitToWidth="true" vbarPolicy="AS_NEEDED" hbarPolicy="NEVER">
                                                   <content>
                                                      <VBox fx:id="notMatchedSkillsBox" prefWidth="460.0" style="-fx-background-color: #FFEBEE; -fx-padding: 10px;" spacing="5.0" />
                                                   </content>
                                                </ScrollPane>
                                             </children>
                                          </VBox>
                                       </children>
                                    </HBox>
                                 </children>
                              </AnchorPane>
                              
                              <!-- Recommendations Section -->
                              <AnchorPane layoutX="20.0" layoutY="570.0" prefHeight="140.0" prefWidth="990.0" styleClass="totalDashboard">
                                 <children>
                                    <Label layoutX="20.0" layoutY="20.0" styleClass="headlineFeature" text="💡 Recommendations" />
                                    <ScrollPane layoutX="20.0" layoutY="60.0" prefHeight="80.0" prefWidth="950.0" style="-fx-background-color: transparent;">
                                       <content>
                                          <VBox fx:id="recommendationsBox" prefWidth="930.0" styleClass="matched_background" spacing="5.0" />
                                       </content>
                                    </ScrollPane>
                                 </children>
                              </AnchorPane>
                              
                              <!-- Warning Label for Course Enrollment -->
                              <AnchorPane fx:id="enrollmentWarningContainer" layoutX="20.0" layoutY="750.0" prefHeight="60.0" prefWidth="990.0" style="-fx-background-color: #FFF3E0; -fx-border-color: #FF9800; -fx-border-width: 2px; -fx-border-radius: 5px; -fx-background-radius: 5px;" visible="false" managed="false">
                                 <children>
                                    <Label fx:id="enrollmentWarningLabel" layoutX="20.0" layoutY="15.0" prefHeight="30.0" prefWidth="950.0" 
                                           text="⚠️ You don't have the required skills or experience for this position. Consider enrolling in our courses to improve your skills and increase your chances of getting hired!" 
                                           style="-fx-text-fill: #E65100; -fx-font-weight: bold; -fx-font-size: 14px;" 
                                           wrapText="true" />
                                 </children>
                              </AnchorPane>
                              
                              <!-- Action Buttons -->
                              <HBox layoutX="20.0" layoutY="830.0" prefHeight="50.0" prefWidth="990.0" spacing="20.0" alignment="CENTER">
                                 <children>
                                    <Button fx:id="applyForJobBtn" mnemonicParsing="false" styleClass="join-btn" text="Apply for Job" prefWidth="180.0" prefHeight="40.0" />
                                    <Button fx:id="enrollInCourseBtn" mnemonicParsing="false" styleClass="watch-btn" text="Enroll in Course" prefWidth="180.0" prefHeight="40.0" />
                                    <Button mnemonicParsing="false" onAction="#handleBackToJobsBtn" styleClass="deshboardBTN" text="Back to Jobs" prefWidth="180.0" prefHeight="40.0" />
                                 </children>
                              </HBox>
                           </children>
                        </AnchorPane>
                     </content>
                  </ScrollPane>
               </children>
            </AnchorPane>
         </children>
      </AnchorPane>
   </children>
</StackPane>